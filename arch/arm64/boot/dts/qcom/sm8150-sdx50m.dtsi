/* Copyright (c) 2018, The Linux Foundation. All rights reserved.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 and
 * only version 2 as published by the Free Software Foundation.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 */

&mdm3 {
	pinctrl-names = "default", "mdm_active", "mdm_suspend";
	pinctrl-0 = <&ap2mdm_pon_reset_default>;
	pinctrl-1 = <&ap2mdm_active &mdm2ap_active>;
	pinctrl-2 = <&ap2mdm_sleep &mdm2ap_sleep>;
	interrupt-map = <0 &tlmm 53 0x3
			1 &tlmm 135 0x3>;
	qcom,mdm2ap-errfatal-gpio = <&tlmm 53 0x00>;
	qcom,ap2mdm-errfatal-gpio = <&tlmm 141 0x00>;
	qcom,mdm2ap-status-gpio   = <&tlmm 142 0x00>;
	qcom,ap2mdm-status-gpio   = <&tlmm 135 0x00>;
	qcom,ap2mdm-soft-reset-gpio = <&pm8150l_gpios 9 0>;
	qcom,mdm-link-info = "0305_01.01.00";
	qcom,esoc-skip-restart-for-mdm-crash;
	status = "ok";
};

&pm8150l_gpios {
	ap2mdm_pon_reset {
		ap2mdm_pon_reset_default: ap2mdm_pon_reset_default {
			/* MDM PON conrol*/
			pins = "gpio9";
			function = "normal";
			power-source = <1>; /* 1.8V */
		};
	};
};

&wil6210 {
	status = "disabled";
};

&mhi_0 {
	esoc-names = "mdm";
	esoc-0 = <&mdm3>;
	qcom,smmu-cfg = <0x1d>;
	qcom,addr-win = <0x0 0x20000000 0x0 0x3fffffff>;
};

&tlmm {
	pcie1 {
		pcie1_sdx50m_wake_default: pcie1_sdx50m_wake_default {
			mux {
				pins = "gpio104";
				function = "gpio";
			};

			config {
				pins = "gpio104";
				drive-strength = <2>;
				bias-disable;
			};
		};
	};
};

&pcie1 {
	dma-coherent;

	pinctrl-0 = <&pcie1_clkreq_default
		&pcie1_perst_default
		&pcie1_sdx50m_wake_default>;
};

&soc {
	imp: qcom,ipa-mhi-proxy {
		compatible = "qcom,ipa-mhi-proxy";
		qcom,ctrl-iova = <0x00010000 0x0FFF0000>;
		qcom,data-iova = <0x10000000 0x0FFFFFFF>;
		qcom,mhi-chdb-base = <0x40300300>;
		qcom,mhi-erdb-base = <0x40300700>;
	};
};

&reserved_memory {
	pil_buffer_p2_mem: pil_buffer_p2_region@a0000000 {
		compatible = "removed-dma-pool";
		no-map;
		reg = <0x0 0xa0000000 0x0 0x01000000>;
	};

	pil_buffer_p1_mem: pil_buffer_p1_region@0a1000000 {
		compatible = "removed-dma-pool";
		no-map;
		reg = <0x0 0xa1000000 0x0 0x02c00000>;
	};

	pil_pcie_mem: pil_pcie_mem_region@a3c00000 {
		compatible = "removed-dma-pool";
		no-map;
		reg = <0x0 0xa3c00000 0x0 0x01000000>;
	};
};
